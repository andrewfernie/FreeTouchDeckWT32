<!DOCTYPE html>
<html lang="en">

	<head>
		<link rel="shortcut icon" href="">
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
		<meta content="utf-8" http-equiv="encoding">
		<meta name=\"viewport\" content=\"width=device-width, initial-scale=1, user-scalable=no\" />
		<title>FreeTouchDeck Configurator</title>
		<link rel="stylesheet" type="text/css" href="style.css">

		<script src="jquery-3.5.1.slim.min.js"></script>
	</head>

	<body>
		<!-- <div id="contentloading" class="pageloading"> Loading the configurator.</div> -->

		<div id="contentloading" class="pageloading">
			Loading Configurator
		</div>

		<div id="ball-loader" class="ball-loader">

			<div class="ball-loader-ball ball1"></div>
			<div class="ball-loader-ball ball2"></div>
			<div class="ball-loader-ball ball3"></div>
		</div>

		<div id="maincontent" style="display: none;">
			<h1>FreeTouchDeck Configurator</h1>
			<form class="form" method="post" action='/upload' id="uploadfile" enctype="multipart/form-data"></form>
			<form class="form" method="post" action='/uploadJSON' id="uploadjsonfile" enctype="multipart/form-data"></form>
			<form class="form" method="get" action='/downloadJSON' id="downloadjsonfile" ></form>

			<!-- Menu -->
			<div class="tab">
				<button class="tablinks" onclick="openMenu(event, 'wifi')">WiFi</button>
				<button class="tablinks" onclick="openMenu(event, 'general')">Settings</button>
				<button class="tablinks" onclick="openMenu(event, 'menu')">Menu</button>
				<button class="tablinks" onclick="openMenu(event, 'uploadimage')">Upload logo</button>

				<form method='post' action='/restart'>
					<button style="float: right;"
						onclick="return confirm('Are you sure? Unsaved configuration will be lost!')" class="tablinks">
						Restart </button>
				</form>

				<button style="float: right;" class="tablinks" onclick="openMenu(event, 'info')">Info</button>

				<button style="float: right;" class="tablinks" onclick="openMenu(event, 'editor')">File editor</button>

				<button style="float: right;" class="tablinks" onclick="openMenu(event, 'uploadjson')">Upload Menu
					Config</button>

				<button style="float: right;" class="tablinks" onclick="openMenu(event, 'downloadjson')">Download Menu
					Config</button>
			</div>

			<!-- Tab Intro -->
			<div id="intro" class="tabcontent">
				<h3>Welcome</h3>
				<p>
					Welcome to the configurator! Select an option/page from the top menu. If you have any questions,
					join my
					Discord server: <a href="https://discord.gg/RE3XevS"
						target="_blank">https://discord.gg/RE3XevS</a><br />
					A guide on how to use the configurator can be found here: <a
						href="https://github.com/DustinWatts/FreeTouchDeck/wiki/3.-The-Configurator" target="_blank">
						FreeTouchDeck Wiki</a>
				</p>
			</div>
			<!-- Tab WiFi -->
			<div id="wifi" class="tabcontent">
				<div style="float: right; font-size: 11px"><a href="/download?file=wificonfig.json">download
						wificonfig.json</a></div><br>
				<h3>WiFi Settings</h3>
				<p>
				<form method='post' id="savewifi" action='/saveconfig'>



					<div style="font-family: Arial, Helvetica, Sans-Serif; Color: #000088;">

						<label for="ssid">WiFi SSID:</label><br>
						<input type="text" id="ssid" name="ssid"><br><br>

						<label for="password">WiFi Password:</label><br>
						<input type="password" id="password" name="password" autocomplete="new-password"><br>
						<input type="checkbox" onclick="togglepassword()">Show Password <br><br>

						&nbsp;&nbsp;Wifi Mode:&nbsp;
						<select class="wifimode" id='wifimode' name='wifimode'>
							<option value="WIFI_STA">Station</option>
							<option value="WIFI_AP">Access Point</option>
						</select><br>

						<label for="wifihostname">Wifi Hostname:</label>
						<input type="text" id="wifihostname" name="wifihostname"><br>

						&nbsp;&nbsp;Connection attempts:&nbsp;
						<select class="attempts" id='attempts' name='attempts'>
							<option value="5">5</option>
							<option value="10">10</option>
							<option value="15">15</option>
							<option value="20">20</option>
						</select><br>

						&nbsp;&nbsp;Delay between attempts:&nbsp;
						<select class="attemptdelay" id='attemptdelay' name='attemptdelay'>
							<option value="100">100 ms</option>
							<option value="500">500 ms</option>
							<option value="1000">1000 ms</option>
							<option value="2000">2000 ms</option>
						</select><br>
					</div>

					<div class="form" style="width: 50%; text-align: : center; margin: auto;">
						<input type="hidden" id='save' name='save' value="wifi">
						<br /><button style='cursor: pointer;' form="savewifi" type='save'>Save WiFi Config</button>
					</div>
				</form>

			</div>
			</p>
		</div>
		<!-- Tab General -->
		<div id="general" class="tabcontent">
			<div style="float: right; font-size: 11px"><a href="/download?file=general.json">download general.json</a>
			</div>
			<br>
			<h3>General Settings</h3>
			<p>
			<div style="font-family: Arial, Helvetica, Sans-Serif; Color: #000088;">
				<h2>Colors</h2>
			</div>

			<form method='post' id="generalconfig" action='/saveconfig'>
				<div style="font-family: Arial, Helvetica, Sans-Serif; Color: #000088;">
					&nbsp;&nbsp;Menu Button Colour:&nbsp;
					<input style='width: 100px; height: 30px; padding:1px; border-radius:0.3rem;' id='menubuttoncolor'
						name='menubuttoncolor' type="color" value=''>
					&nbsp;&nbsp;Function Button Colour:&nbsp;
					<input style='width: 100px; height: 30px; padding:1px; border-radius:0.3rem;'
						id='functionbuttoncolor' name='functionbuttoncolor' type="color" value=''>
					&nbsp;&nbsp;Latch Colour:&nbsp;
					<input style='width: 100px; height: 30px; padding:1px; border-radius:0.3rem;' id='latchcolor'
						name='latchcolor' type="color" value=''>
					&nbsp;&nbsp;Background Colour:&nbsp;
					<input style='width: 100px; height: 30px; padding:1px; border-radius:0.3rem;' id='background'
						name='background' type="color" value=''>
				</div><br>

				<div style="font-family: Arial, Helvetica, Sans-Serif; Color: #000088;">
					<h2>Deep Sleep</h2>
				</div>

				&nbsp;&nbsp;Deep Sleep:&nbsp;
				<select class="sleepenable" id='sleepenable' name='sleepenable'>
					<option value="true">Enabled</option>
					<option value="false">Disabled</option>
				</select>
				&nbsp;&nbsp;Deep Sleep Timer:&nbsp;
				<select class="sleeptimer" id='sleeptimer' name='sleeptimer'>
					<option value="10">10 Minutes</option>
					<option value="20">20 Minutes</option>
					<option value="30">30 Minutes</option>
					<option value="60">60 Minutes</option>
				</select>
				&nbsp;&nbsp;USB Comms:&nbsp;
				<select class="usbcommsenable" id='usbcommsenable' name='usbcommsenable'>
					<option value="true">Enabled</option>
					<option value="false">Disabled</option>
				</select>
				<div style="font-family: Arial, Helvetica, Sans-Serif; Color: #000088;">
					<h2>Sound</h2>
				</div>

				&nbsp;&nbsp;Beep on Touch:&nbsp;
				<select class="sleepenable" id='beep' name='beep'>
					<option value="true">Enabled</option>
					<option value="false">Disabled</option>
				</select>

				<div style="font-family: Arial, Helvetica, Sans-Serif; Color: #000088;">
					<h2>FreeTouchDeck Helpers</h2>
				</div>

				&nbsp;&nbsp;Modifier 1:&nbsp;
				<select class="modifier1" id='modifier1' name='modifier1'>
					<option value="0">None</option>
					<option value="128">CTRL</option>
					<option value="129">SHIFT</option>
					<option value="130">ALT</option>
					<option value="131">GUI</option>
				</select>

				&nbsp;&nbsp;Modifier 2:&nbsp;
				<select class="modifier2" id='modifier2' name='modifier2'>
					<option value="0">None</option>
					<option value="128">CTRL</option>
					<option value="129">SHIFT</option>
					<option value="130">ALT</option>
					<option value="131">GUI</option>
				</select>

				&nbsp;&nbsp;Modifier 3:&nbsp;
				<select class="modifier3" id='modifier3' name='modifier3'>
					<option value="0">None</option>
					<option value="128">CTRL</option>
					<option value="129">SHIFT</option>
					<option value="130">ALT</option>
					<option value="131">GUI</option>
				</select>

				<br>

				&nbsp;&nbsp;Delay after helper (ms):&nbsp;
				<select class="helperdelay" id='helperdelay' name='helperdelay'>
					<option value="0">0</option>
					<option value="100">100</option>
					<option value="200">200</option>
					<option value="500">500</option>
					<option value="1000">1000</option>
				</select>

				&nbsp;&nbsp;Menu on startup:&nbsp;
				<select class="startup_menu" id='startup_menu' name='startup_menu'>
					<option value="0">0</option>
					<option value="1">1</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5</option>
					<option value="6">6</option>
					<option value="7">7</option>
					<option value="8">8</option>
					<option value="9">9</option>
				</select>
				<div class="form" style="width: 50%; text-align: : center; margin: auto;">
					<input type="hidden" id='save' name='save' value="general">
					<br /><button style='cursor: pointer;' form="generalconfig" type='save'>Save General Config</button>
				</div>
			</form>
		</div>
		</p>
		</div>
		<!-- Tab Menu -->
		<div id="menu" class="tabcontent">
			<div style="float: right; font-size: 11px"><a href="/download?file=menu1.json">download menu1.json</a></div>
			<br>
			<h3>Menu</h3>
			<p>
			<form method='post' id="savemenu" action='/saveconfig'>
				<label for="framework">Select Menu</label>
				<select name="menunumberlist_save" id="menunumberlist_save" onchange="updateMenuItems(this)">
					<option value="0">Home Menu</option>
					<option value="1">Menu 1</option>
					<option value="2">Menu 2</option>
					<option value="3">Menu 3</option>
					<option value="4">Menu 4</option>
					<option value="5">Menu 5</option>
					<option value="6">Menu 6</option>
					<option value="7">Menu 7</option>
					<option value="8">Menu 8</option>
					<option value="9">Menu 9</option>
				</select>
				<div></div>		<!-- Add a little space -->
				<label for="menuname">Menu Name:</label>
				<input type="text" id="menuname" name="menuname"><br><br>
				<div></div>		<!-- Add a little space -->
				<table style="height: 250px; width: 100%; border: 1px solid #000088; text-align: left;">
					<tbody>
						<tr>
							<td style="width: 10%;">
								Row/Col
							</td>
							<td style="width: 18%;">
								Col 1
							</td>
							<td style="width: 18%;">
								Col 2
							</td>
							<td style="width: 18%;">
								Col 3
							</td>
							<td style="width: 18%;">
								Col 4
							</td>
							<td style="width: 18%;">
								Col 5
							</td>
						</tr>
						<tr>
							<td style="width: 10%;">
								Row 1
							</td>
							<td style="width: 18%;">
								Button 1-1
								<br />Image:
								<select class="images" id='button11logo' name='button11logo'></select>
								<br />Action 1:
								<select class="actions" id='button11action0' name='button11action0'></select>
								<select class="actions" id='button11value0' name='button11value0'></select>
								<br />Action 2:
								<select class="actions" id='button11action1' name='button11action1'></select>
								<select class="actions" id='button11value1' name='button11value1'></select>
								<br />Action 3:
								<select class="actions" id='button11action2' name='button11action2'></select>
								<select class="actions" id='button11value2' name='button11value2'></select>
								<br />Latch? <input type="checkbox" id="button11latch" name="button11latch">
								latch to: <select class="images" id='button11latchlogo'
									name='button11latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 1-2
								<br />Image:
								<select class="images" id='button12logo' name='button12logo'></select>
								<br />Action 1:
								<select class="actions" id='button12action0' name='button12action0'></select>
								<select class="actions" id='button12value0' name='button12value0'></select>
								<br />Action 2:
								<select class="actions" id='button12action1' name='button12action1'></select>
								<select class="actions" id='button12value1' name='button12value1'></select>
								<br />Action 3:
								<select class="actions" id='button12action2' name='button12action2'></select>
								<select class="actions" id='button12value2' name='button12value2'></select>
								<br />Latch? <input type="checkbox" id="button12latch" name="button12latch">
								latch to: <select class="images" id='button12latchlogo'
									name='button12latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 1-3
								<br />Image:
								<select class="images" id='button13logo' name='button13logo'></select>
								<br />Action 1:
								<select class="actions" id='button13action0' name='button13action0'></select>
								<select class="actions" id='button13value0' name='button13value0'></select>
								<br />Action 2:
								<select class="actions" id='button13action1' name='button13action1'></select>
								<select class="actions" id='button13value1' name='button13value1'></select>
								<br />Action 3:
								<select class="actions" id='button13action2' name='button13action2'></select>
								<select class="actions" id='button13value2' name='button13value2'></select>
								<br />Latch? <input type="checkbox" id="button13latch" name="button13latch">
								latch to: <select class="images" id='button13latchlogo'
									name='button13latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 1-4
								<br />Image:
								<select class="images" id='button14logo' name='button14logo'></select>
								<br />Action 1:
								<select class="actions" id='button14action0' name='button14action0'></select>
								<select class="actions" id='button14value0' name='button14value0'></select>
								<br />Action 2:
								<select class="actions" id='button14action1' name='button14action1'></select>
								<select class="actions" id='button14value1' name='button14value1'></select>
								<br />Action 3:
								<select class="actions" id='button14action2' name='button14action2'></select>
								<select class="actions" id='button14value2' name='button14value2'></select>
								<br />Latch? <input type="checkbox" id="button14latch" name="button14latch">
								latch to: <select class="images" id='button14latchlogo'
									name='button14latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 1-5
								<br />Image:
								<select class="images" id='button15logo' name='button15logo'></select>
								<br />Action 1:
								<select class="actions" id='button15action0' name='button15action0'></select>
								<select class="actions" id='button15value0' name='button15value0'></select>
								<br />Action 2:
								<select class="actions" id='button15action1' name='button15action1'></select>
								<select class="actions" id='button15value1' name='button15value1'></select>
								<br />Action 3:
								<select class="actions" id='button15action2' name='button15action2'></select>
								<select class="actions" id='button15value2' name='button15value2'></select>
								<br />Latch? <input type="checkbox" id="button15latch" name="button15latch">
								latch to: <select class="images" id='button15latchlogo'
									name='button15latchlogo'></select>
							</td>
						</tr>
						<tr>
							<td style="width: 10%;">
								Row 2
							</td>
							<td style="width: 18%;">
								Button 2-1
								<br />Image:
								<select class="images" id='button21logo' name='button21logo'></select>
								<br />Action 1:
								<select class="actions" id='button21action0' name='button21action0'></select>
								<select class="actions" id='button21value0' name='button21value0'></select>
								<br />Action 2:
								<select class="actions" id='button21action1' name='button21action1'></select>
								<select class="actions" id='button21value1' name='button21value1'></select>
								<br />Action 3:
								<select class="actions" id='button21action2' name='button21action2'></select>
								<select class="actions" id='button21value2' name='button21value2'></select>
								<br />Latch? <input type="checkbox" id="button21latch" name="button21latch">
								latch to: <select class="images" id='button21latchlogo'
									name='button21latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 2-2
								<br />Image:
								<select class="images" id='button22logo' name='button22logo'></select>
								<br />Action 1:
								<select class="actions" id='button22action0' name='button22action0'></select>
								<select class="actions" id='button22value0' name='button22value0'></select>
								<br />Action 2:
								<select class="actions" id='button22action1' name='button22action1'></select>
								<select class="actions" id='button22value1' name='button22value1'></select>
								<br />Action 3:
								<select class="actions" id='button22action2' name='button22action2'></select>
								<select class="actions" id='button22value2' name='button22value2'></select>
								<br />Latch? <input type="checkbox" id="button22latch" name="button22latch">
								latch to: <select class="images" id='button22latchlogo'
									name='button22latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 2-3
								<br />Image:
								<select class="images" id='button23logo' name='button23logo'></select>
								<br />Action 1:
								<select class="actions" id='button23action0' name='button23action0'></select>
								<select class="actions" id='button23value0' name='button23value0'></select>
								<br />Action 2:
								<select class="actions" id='button23action1' name='button23action1'></select>
								<select class="actions" id='button23value1' name='button23value1'></select>
								<br />Action 3:
								<select class="actions" id='button23action2' name='button23action2'></select>
								<select class="actions" id='button23value2' name='button23value2'></select>
								<br />Latch? <input type="checkbox" id="button23latch" name="button23latch">
								latch to: <select class="images" id='button23latchlogo'
									name='button23latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 2-4
								<br />Image:
								<select class="images" id='button24logo' name='button24logo'></select>
								<br />Action 1:
								<select class="actions" id='button24action0' name='button24action0'></select>
								<select class="actions" id='button24value0' name='button24value0'></select>
								<br />Action 2:
								<select class="actions" id='button24action1' name='button24action1'></select>
								<select class="actions" id='button24value1' name='button24value1'></select>
								<br />Action 3:
								<select class="actions" id='button24action2' name='button24action2'></select>
								<select class="actions" id='button24value2' name='button24value2'></select>
								<br />Latch? <input type="checkbox" id="button24latch" name="button24latch">
								latch to: <select class="images" id='button24latchlogo'
									name='button24latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 2-5
								<br />Image:
								<select class="images" id='button25logo' name='button25logo'></select>
								<br />Action 1:
								<select class="actions" id='button25action0' name='button25action0'></select>
								<select class="actions" id='button25value0' name='button25value0'></select>
								<br />Action 2:
								<select class="actions" id='button25action1' name='button25action1'></select>
								<select class="actions" id='button25value1' name='button25value1'></select>
								<br />Action 3:
								<select class="actions" id='button25action2' name='button25action2'></select>
								<select class="actions" id='button25value2' name='button25value2'></select>
								<br />Latch? <input type="checkbox" id="button25latch" name="button25latch">
								latch to: <select class="images" id='button25latchlogo'
									name='button25latchlogo'></select>
							</td>
						</tr>
						<tr>
							<td style="width: 10%;">
								Row 3
							</td>
							<td style="width: 18%;">
								Button 3-1
								<br />Image:
								<select class="images" id='button31logo' name='button31logo'></select>
								<br />Action 1:
								<select class="actions" id='button31action0' name='button31action0'></select>
								<select class="actions" id='button31value0' name='button31value0'></select>
								<br />Action 2:
								<select class="actions" id='button31action1' name='button31action1'></select>
								<select class="actions" id='button31value1' name='button31value1'></select>
								<br />Action 3:
								<select class="actions" id='button31action2' name='button31action2'></select>
								<select class="actions" id='button31value2' name='button31value2'></select>
								<br />Latch? <input type="checkbox" id="button31latch" name="button31latch">
								latch to: <select class="images" id='button31latchlogo'
									name='button31latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 3-2
								<br />Image:
								<select class="images" id='button32logo' name='button32logo'></select>
								<br />Action 1:
								<select class="actions" id='button32action0' name='button32action0'></select>
								<select class="actions" id='button32value0' name='button32value0'></select>
								<br />Action 2:
								<select class="actions" id='button32action1' name='button32action1'></select>
								<select class="actions" id='button32value1' name='button32value1'></select>
								<br />Action 3:
								<select class="actions" id='button32action2' name='button32action2'></select>
								<select class="actions" id='button32value2' name='button32value2'></select>
								<br />Latch? <input type="checkbox" id="button32latch" name="button32latch">
								latch to: <select class="images" id='button32latchlogo'
									name='button32latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 3-3
								<br />Image:
								<select class="images" id='button33logo' name='button33logo'></select>
								<br />Action 1:
								<select class="actions" id='button33action0' name='button33action0'></select>
								<select class="actions" id='button33value0' name='button33value0'></select>
								<br />Action 2:
								<select class="actions" id='button33action1' name='button33action1'></select>
								<select class="actions" id='button33value1' name='button33value1'></select>
								<br />Action 3:
								<select class="actions" id='button33action2' name='button33action2'></select>
								<select class="actions" id='button33value2' name='button33value2'></select>
								<br />Latch? <input type="checkbox" id="button33latch" name="button33latch">
								latch to: <select class="images" id='button33latchlogo'
									name='button33latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 3-4
								<br />Image:
								<select class="images" id='button34logo' name='button34logo'></select>
								<br />Action 1:
								<select class="actions" id='button34action0' name='button34action0'></select>
								<select class="actions" id='button34value0' name='button34value0'></select>
								<br />Action 2:
								<select class="actions" id='button34action1' name='button34action1'></select>
								<select class="actions" id='button34value1' name='button34value1'></select>
								<br />Action 3:
								<select class="actions" id='button34action2' name='button34action2'></select>
								<select class="actions" id='button34value2' name='button34value2'></select>
								<br />Latch? <input type="checkbox" id="button34latch" name="button34latch">
								latch to: <select class="images" id='button34latchlogo'
									name='button34latchlogo'></select>
							</td>
							<td style="width: 18%;">
								Button 3-5
								<br />Image:
								<select class="images" id='button35logo' name='button35logo'></select>
								<br />Action 1:
								<select class="actions" id='button35action0' name='button35action0'></select>
								<select class="actions" id='button35value0' name='button35value0'></select>
								<br />Action 2:
								<select class="actions" id='button35action1' name='button35action1'></select>
								<select class="actions" id='button35value1' name='button35value1'></select>
								<br />Action 3:
								<select class="actions" id='button35action2' name='button35action2'></select>
								<select class="actions" id='button35value2' name='button35value2'></select>
								<br />Latch? <input type="checkbox" id="button35latch" name="button35latch">
								latch to: <select class="images" id='button35latchlogo'
									name='button35latchlogo'></select>
							</td>
						</tr>
					</tbody>
				</table>
				<div class="form" style="width: 50%; text-align: : center; margin: auto;">
					<input type="hidden" id='save' name='save' value="menu">
					<br /><button style='cursor: pointer;' form="savemenu" type='save'>Save Menu Config</button>
			</form>
		</div>
		</p>
		</div>
		<!-- Upload Logo -->
		<div id="uploadimage" class="tabcontent">
			<h3>Upload a new logo</h3>
			<div style="width: 70%; text-align: left; margin: auto;"> You can customize the logos that are used. If you
				upload a file with a name that already exists, the file is <u>overwritten</u>. You can only upload .bmp
				images. There images should be in a 24-bit RGB format and should be no more then 75x75 pixels. Smaller
				images are supported.<br /><br />

				Images that are used for Elgato's Stream Deck are also supported. These should also be in a 24-bit RGB
				format. You can convert these using free online tools like <a
					href="https://online-converting.com/image/convert2bmp/"
					target="_blank">https://online-converting.com/image/convert2bmp/</a>.<br /><br />

				FreeTouchDeck will check the colour of the first pixel in the image. If that pixel is black (#000000),
				all
				black pixels will be rendered as transparent and the button colour chosen in the "General" tab will be
				used.
				If that pixel has a colour, the button will have that colour so that the image blends in nicely.
			</div>
			<p>
			<div class="form" style="width: 10%; text-align: : center; margin: auto;">
				<input form="uploadfile" type="file" name="name" accept=".bmp"><br /><br />
				<button style='cursor: pointer;' form="uploadfile" type="save">Upload</button>
			</div>
			</p>
		</div>

		<!-- File Editor -->
		<div id="editor" class="tabcontent">
			<h3>Remove files</h3>

			<div class="form" id=deletefilelist style="width: 20%; text-align: left; margin: auto;">

			</div>

		</div>

		<!-- Upload JSON -->
		<div id="uploadjson" class="tabcontent">
			<h3>Upload a JSON Config File</h3>
			<div style="width: 70%; text-align: left; margin: auto;"> You can upload a previously downloaded JSON file
				to save you some time from having to configure a whole menu. The filename should be the menu name (all
				lower-case), e.g. menu.json for Menu, menu2.json for Menu 2, etc. It is also a good idea to validate
				your .json file if you made any manual modifications. You can do that using 
				<a href="https://jsonlint.com/"	target="_blank">JSONLint</a>
				<br /><br />
			</div>
			<p>
			<div class="form" style="width: 10%; text-align: center; margin: auto;">
				<input form="uploadjsonfile" type="file" name="name" accept=".json"><br /><br />
				<button style='cursor: pointer;' form="uploadjsonfile" type="save">Upload JSON</button>
			</div>
			</p>
		</div>

		<!-- Download JSON -->
		<div id="downloadjson" class="tabcontent">
			<h3>Download a Menu Config File</h3>
			<div style="width: 70%; text-align: center; margin: auto;"> Select a file from the list and download it to
				the client computer. <br /><br /></div>
			<p>
			<div class="form" style="width: 20%; text-align: center; margin: auto;">
				<label for="framework">Select Menu</label>
				<!--					<select onchange="updateMenuItems(this)" class="menunumber" id='menunumber' name='menunumber'> -->
				<select name="menunumberlist_download" id="menunumberlist_download" form="downloadjsonfile">
					<option value="0">Home Menu</option>
					<option value="1">Menu 1</option>
					<option value="2">Menu 2</option>
					<option value="3">Menu 3</option>
					<option value="4">Menu 4</option>
					<option value="5">Menu 5</option>
					<option value="6">Menu 6</option>
					<option value="7">Menu 7</option>
					<option value="8">Menu 8</option>
					<option value="9">Menu 9</option>
				</select>
				<br /><br />
				<!-- <input form="downloadjsonfile" type=hidden name="name" ><br /><br /> -->
				<button style='cursor: pointer;' form="downloadjsonfile" type="save">Download</button>
			</div>
			</p>
		</div>

		<!-- INFO -->
		<div id="info" class="tabcontent">
			<h3>About FreeTouchDeck</h3>
			<div id="infocontent" style="width: 40%; text-align: left; margin: auto;">

			</div>
			<p>
		</div>
		</div>

		</div>


		<!--  Password toggle -->
		<script>
		function togglepassword() {
			var field = document.getElementById("password");
			if (field.type === "password") {
				field.type = "text";
			} else {
				field.type = "password";
			}
		}
		</script>

		<!-- Menu Handler -->
		<script>
		function openMenu(evt, menuitem) {
			// Declare all variables
			var i, tabcontent, tablinks;

			// Get all elements with class="tabcontent" and hide them
			tabcontent = document.getElementsByClassName("tabcontent");
			for (i = 0; i < tabcontent.length; i++) {
				tabcontent[i].style.display = "none";
			}

			// Get all elements with class="tablinks" and remove the class "active"
			tablinks = document.getElementsByClassName("tablinks");
			for (i = 0; i < tablinks.length; i++) {
				tablinks[i].className = tablinks[i].className.replace(" active", "");
			}

			// Show the current tab, and add an "active" class to the button that opened the tab
			console.log("openMenu():", menuitem);

			if (menuitem == 'menu') {
				getMenuConfig(0);               // load the first menu data
			}
			document.getElementById(menuitem).style.display = "block";
			evt.currentTarget.className += " active";
		}

		document.addEventListener('DOMContentLoaded', openMenu(event, 'intro'), false);
		</script>

		<!-- Load the array with all the dropdown menu items  -->
		<script>
		var selecteditems = [{
			name: 'Do Nothing',
			value: '0',
			subitems: [{
				name: '--',
				value: '0'
			}]
		},
		{
			name: 'Delay',
			value: '1',
			subitems: [{
				name: '100ms',
				value: '100'
			},
			{
				name: '200ms',
				value: '200'
			}
				,
			{
				name: '500ms',
				value: '500'
			}
				,
			{
				name: '1000ms',
				value: '1000'
			}
			]
		},
		{
			name: 'Arrows and TAB',
			value: '2',
			subitems: [{
				name: '--',
				value: '0'
			},
			{
				name: 'UP Arrow',
				value: '1'
			},
			{
				name: 'DOWN Arrow',
				value: '2'
			},
			{
				name: 'LEFT Arrow',
				value: '3'
			},
			{
				name: 'RIGHT Arrow',
				value: '4'
			},
			{
				name: 'Backspace',
				value: '5'
			},
			{
				name: 'TAB',
				value: '6'
			},
			{
				name: 'Return',
				value: '7'
			},
			{
				name: 'Page Up',
				value: '8'
			},
			{
				name: 'Page Down',
				value: '9'
			},
			{
				name: 'Delete',
				value: '10'
			},
			{
				name: 'PrintScreen',
				value: '11'
			},
			{
				name: 'ESC',
				value: '12'
			},
			{
				name: 'HOME',
				value: '13'
			},
			{
				name: 'END',
				value: '14'
			}
			]
		},
		{
			name: 'Mediakey',
			value: '3',
			subitems: [{
				name: 'Mute',
				value: '1'
			},
			{
				name: 'Volume Down',
				value: '2'
			},
			{
				name: 'Volume Up',
				value: '3'
			},
			{
				name: 'Play/Pause',
				value: '4'
			},
			{
				name: 'Stop',
				value: '5'
			},
			{
				name: 'Next',
				value: '6'
			},
			{
				name: 'Previous',
				value: '7'
			},
			{
				name: 'WWW Home',
				value: '8'
			},
			{
				name: 'File Browser',
				value: '9'
			},
			{
				name: 'Calculator',
				value: '10'
			},
			{
				name: 'WWW Bookmarks',
				value: '11'
			},
			{
				name: 'WWW Search',
				value: '12'
			},
			{
				name: 'WWW Stop',
				value: '13'
			},
			{
				name: 'WWW Back',
				value: '14'
			},
			{
				name: 'Cons Control',
				value: '15'
			},
			{
				name: 'Email App',
				value: '16'
			}
			]
		},
		{
			name: 'Letters',
			value: '4',
			subitems: [{
				name: '-space-',
				value: ' '
			},
			{
				name: 'a',
				value: 'a'
			},
			{
				name: 'b',
				value: 'b'
			},
			{
				name: 'c',
				value: 'c'
			},
			{
				name: 'd',
				value: 'd'
			},
			{
				name: 'e',
				value: 'e'
			},
			{
				name: 'f',
				value: 'f'
			},
			{
				name: 'g',
				value: 'g'
			},
			{
				name: 'h',
				value: 'h'
			},
			{
				name: 'i',
				value: 'i'
			},
			{
				name: 'j',
				value: 'j'
			},
			{
				name: 'k',
				value: 'k'
			},
			{
				name: 'l',
				value: 'l'
			},
			{
				name: 'm',
				value: 'm'
			},
			{
				name: 'n',
				value: 'n'
			},
			{
				name: 'o',
				value: 'o'
			},
			{
				name: 'p',
				value: 'p'
			},
			{
				name: 'q',
				value: 'q'
			},
			{
				name: 'r',
				value: 'r'
			},
			{
				name: 's',
				value: 's'
			},
			{
				name: 't',
				value: 't'
			},
			{
				name: 'u',
				value: 'u'
			},
			{
				name: 'v',
				value: 'v'
			},
			{
				name: 'w',
				value: 'w'
			},
			{
				name: 'x',
				value: 'x'
			},
			{
				name: 'y',
				value: 'y'
			},
			{
				name: 'z',
				value: 'z'
			}

			]
		},
		{
			name: 'Option Keys',
			value: '5',
			subitems: [{
				name: 'Left CTRL',
				value: '1'
			},
			{
				name: 'Left Shift',
				value: '2'
			},
			{
				name: 'Left ALT',
				value: '3'
			},
			{
				name: 'Left GUI',
				value: '4'
			},
			{
				name: 'Right CTRL',
				value: '5'
			},
			{
				name: 'Right Shift',
				value: '6'
			},
			{
				name: 'Right ALT',
				value: '7'
			},
			{
				name: 'Right GUI',
				value: '8'
			},
			{
				name: 'Release All',
				value: '9'
			}]
		},
		{
			name: 'Function Keys',
			value: '6',
			subitems: [{
				name: 'F1',
				value: '1'
			},
			{
				name: 'F2',
				value: '2'
			},
			{
				name: 'F3',
				value: '3'
			},
			{
				name: 'F4',
				value: '4'
			},
			{
				name: 'F5',
				value: '5'
			},
			{
				name: 'F6',
				value: '6'
			},
			{
				name: 'F7',
				value: '7'
			},
			{
				name: 'F8',
				value: '8'
			},
			{
				name: 'F9',
				value: '9'
			},
			{
				name: 'F10',
				value: '10'
			},
			{
				name: 'F11',
				value: '11'
			},
			{
				name: 'F12',
				value: '12'
			},
			{
				name: 'F13',
				value: '13'
			},
			{
				name: 'F14',
				value: '14'
			},
			{
				name: 'F15',
				value: '15'
			},
			{
				name: 'F16',
				value: '16'
			},
			{
				name: 'F17',
				value: '17'
			},
			{
				name: 'F18',
				value: '18'
			},
			{
				name: 'F19',
				value: '19'
			},
			{
				name: 'F20',
				value: '20'
			},
			{
				name: 'F21',
				value: '21'
			},
			{
				name: 'F22',
				value: '22'
			},
			{
				name: 'F23',
				value: '23'
			},
			{
				name: 'F24',
				value: '24'
			}
			]
		},
		{
			name: 'Numbers',
			value: '7',
			subitems: [{
				name: '0',
				value: '0'
			},
			{
				name: '1',
				value: '1'
			},
			{
				name: '2',
				value: '2'
			},
			{
				name: '3',
				value: '3'
			},
			{
				name: '4',
				value: '4'
			},
			{
				name: '5',
				value: '5'
			},
			{
				name: '6',
				value: '6'
			},
			{
				name: '7',
				value: '7'
			},
			{
				name: '8',
				value: '8'
			},
			{
				name: '9',
				value: '9'
			}

			]
		},
		{
			name: 'Special Chars',
			value: '8',
			subitems: [{
				name: '.',
				value: '.'
			},
			{
				name: ',',
				value: ','
			},
			{
				name: '!',
				value: '!'
			},
			{
				name: '?',
				value: '?'
			},
			{
				name: '/',
				value: '/'
			},
			{
				name: '+',
				value: '+'
			},
			{
				name: '-',
				value: '-'
			},
			{
				name: '&',
				value: '&'
			},
			{
				name: '^',
				value: '^'
			},
			{
				name: '%',
				value: '%'
			},
			{
				name: '*',
				value: '*'
			},
			{
				name: '#',
				value: '#'
			},
			{
				name: '$',
				value: '$'
			},
			{
				name: '[',
				value: '['
			},
			{
				name: ']',
				value: ']'
			}

			]
		},
		{
			name: 'Combos',
			value: '9',
			subitems: [{
				name: 'LEFT CTRL+SHIFT',
				value: '1'
			},
			{
				name: 'LEFT ALT+SHIFT',
				value: '2'
			},
			{
				name: 'LEFT GUI+SHIFT',
				value: '3'
			},
			{
				name: 'LEFT CTRL+GUI',
				value: '4'
			},
			{
				name: 'LEFT ALT+GUI',
				value: '5'
			},
			{
				name: 'LEFT CTRL+ALT',
				value: '6'
			},
			{
				name: 'LEFT CTRL+ALT+GUI',
				value: '7'
			},
			{
				name: 'RIGHT CTRL+SHIFT',
				value: '8'
			},
			{
				name: 'RIGHT ALT+SHIFT',
				value: '9'
			},
			{
				name: 'RIGHT GUI+SHIFT',
				value: '10'
			},
			{
				name: 'RIGHT CTRL+GUI',
				value: '11'
			},
			{
				name: 'RIGHT ALT+GUI',
				value: '12'
			},
			{
				name: 'RIGHT CTRL+ALT',
				value: '13'
			},
			{
				name: 'RIGHT CTRL+ALT+GUI',
				value: '14'
			}

			]
		},
		{
			name: 'Helpers',
			value: '10',
			subitems: [{
				name: 'Helper 1',
				value: '1'
			},
			{
				name: 'Helper 2',
				value: '2'
			},
			{
				name: 'Helper 3',
				value: '3'
			},
			{
				name: 'Helper 4',
				value: '4'
			},
			{
				name: 'Helper 5',
				value: '5'
			},
			{
				name: 'Helper 6',
				value: '6'
			},
			{
				name: 'Helper 7',
				value: '7'
			},
			{
				name: 'Helper 8',
				value: '8'
			},
			{
				name: 'Helper 9',
				value: '9'
			},
			{
				name: 'Helper 10',
				value: '10'
			},
			{
				name: 'Helper 11',
				value: '11'
			}

			]
		},
		{
			name: 'FTD Functions',
			value: '11',
			subitems: [{
				name: 'Config Mode',
				value: '1'
			},
			{
				name: 'Brightness Up',
				value: '2'
			},
			{
				name: 'Brightness Down',
				value: '3'
			},
			{
				name: 'Enable/Disable Sleep',
				value: '4'
			},
			{
				name: 'Info Page',
				value: '5'
			},
			{
				name: 'Goto Menu 0 (Home)',
				value: '6'
			},
			{
				name: 'Save General Config',
				value: '7'
			},
			{
				name: 'Enable USB Comms',
				value: '8'
			}
			]
		},
		{
			name: 'Numpad',
			value: '12',
			subitems: [{
				name: 'Numpad 0',
				value: '0'
			},
			{
				name: 'Numpad 1',
				value: '1'
			},
			{
				name: 'Numpad 2',
				value: '2'
			},
			{
				name: 'Numpad 3',
				value: '3'
			},
			{
				name: 'Numpad 4',
				value: '4'
			},
			{
				name: 'Numpad 5',
				value: '5'
			},
			{
				name: 'Numpad 6',
				value: '6'
			},
			{
				name: 'Numpad 7',
				value: '7'
			},
			{
				name: 'Numpad 8',
				value: '8'
			},
			{
				name: 'Numpad 9',
				value: '9'
			},
			{
				name: 'Numpad /',
				value: '10'
			},
			{
				name: 'Numpad *',
				value: '11'
			},
			{
				name: 'Numpad -',
				value: '12'
			},
			{
				name: 'Numpad +',
				value: '13'
			},
			{
				name: 'Numpad RETURN',
				value: '14'
			},
			{
				name: 'Numpad .',
				value: '15'
			}

			]
		},
		{
			name: 'User Actions',
			value: '13',
			subitems: [{
				name: 'Action 1',
				value: '1'
			},
			{
				name: 'Action 2',
				value: '2'
			},
			{
				name: 'Action 3',
				value: '3'
			},
			{
				name: 'Action 4',
				value: '4'
			},
			{
				name: 'Action 5',
				value: '5'
			},
			{
				name: 'Action 6',
				value: '6'
			},
			{
				name: 'Action 7',
				value: '7'
			}

			]
		},
		{
			name: 'Goto Page',
			value: '14',
			subitems: [{
				name: 'Page 0',
				value: '0'
			}, {
				name: 'Page 1',
				value: '1'
			}, {
				name: 'Page 2',
				value: '2'
			}, {
				name: 'Page 3',
				value: '3'
			}, {
				name: 'Page 4',
				value: '4'
			}, {
				name: 'Page 5',
				value: '5'
			}, {
				name: 'Page 6',
				value: '6'
			}, {
				name: 'Page 7',
				value: '7'
			}, {
				name: 'Page 8',
				value: '8'
			}, {
				name: 'Page 9',
				value: '9'
			}

			]
		}
		];
		</script>

		<!-- Look for change in savemenu form. Then find out what was changed so that value lists can be updated -->
		<script>
		$(function () {
			$('#savemenu')
					.change(function () {
						// var value = $(this).val();
						// var menu = $('#button11value0');

						// menu.empty();
						// $.each(temp[value], function () {
						// 	$('<option />')
						// 		.attr('value', this.value)
						// 		.html(this.name)
						// 		.appendTo(menu);
						// });
						console.log("Change detected in form savemenu.")
					});
		});	

		</script>


		<!-- Loading button function -->
		<script>

		// TODO: Find some way to get rid of the per-button duplicated code below

		var items = selecteditems.slice(0); // Create a duplicate of the selecteditems array for now

		$(function () {
			var temp = {};
			////////////////////////// Row 1 ///////////////////////////
			// menu button11
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button11action0');
				temp[this.value] = this.subitems;
			});

			$('#button11action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button11value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button11action1');
				temp[this.value] = this.subitems;
			});

			$('#button11action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button11value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button11action2');
				temp[this.value] = this.subitems;
			});

			$('#button11action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button11value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menuButton 12
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button12action0');
				temp[this.value] = this.subitems;
			});

			$('#button12action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button12value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button12action1');
				temp[this.value] = this.subitems;
			});

			$('#button12action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button12value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button12action2');
				temp[this.value] = this.subitems;
			});

			$('#button12action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button12value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu Button13
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button13action0');
				temp[this.value] = this.subitems;
			});

			$('#button13action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button13value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button13action1');
				temp[this.value] = this.subitems;
			});

			$('#button13action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button13value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button13action2');
				temp[this.value] = this.subitems;
			});

			$('#button13action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button13value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu button14
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button14action0');
				temp[this.value] = this.subitems;
			});

			$('#button14action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button14value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button14action1');
				temp[this.value] = this.subitems;
			});

			$('#button14action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button14value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button14action2');
				temp[this.value] = this.subitems;
			});

			$('#button14action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button14value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu button15
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button15action0');
				temp[this.value] = this.subitems;
			});

			$('#button15action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button15value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button15action1');
				temp[this.value] = this.subitems;
			});

			$('#button15action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button15value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button15action2');
				temp[this.value] = this.subitems;
			});

			$('#button15action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button15value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();
			////////////////////////// Row 2 ///////////////////////////
			// menu button21
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button21action0');
				temp[this.value] = this.subitems;
			});

			$('#button21action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button21value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button21action1');
				temp[this.value] = this.subitems;
			});

			$('#button21action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button21value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button21action2');
				temp[this.value] = this.subitems;
			});

			$('#button21action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button21value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menuButton 22
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button22action0');
				temp[this.value] = this.subitems;
			});

			$('#button22action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button22value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button22action1');
				temp[this.value] = this.subitems;
			});

			$('#button22action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button22value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button22action2');
				temp[this.value] = this.subitems;
			});

			$('#button22action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button22value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu Button23
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button23action0');
				temp[this.value] = this.subitems;
			});

			$('#button23action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button23value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button23action1');
				temp[this.value] = this.subitems;
			});

			$('#button23action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button23value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button23action2');
				temp[this.value] = this.subitems;
			});

			$('#button23action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button23value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu button24
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button24action0');
				temp[this.value] = this.subitems;
			});

			$('#button24action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button24value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button24action1');
				temp[this.value] = this.subitems;
			});

			$('#button24action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button24value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button24action2');
				temp[this.value] = this.subitems;
			});

			$('#button24action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button24value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu button25
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button25action0');
				temp[this.value] = this.subitems;
			});

			$('#button25action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button25value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button25action1');
				temp[this.value] = this.subitems;
			});

			$('#button25action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button25value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button25action2');
				temp[this.value] = this.subitems;
			});

			$('#button25action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button25value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			////////////////////////// Row 3 ///////////////////////////
			// menu button31
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button31action0');
				temp[this.value] = this.subitems;
			});

			$('#button31action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button31value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button31action1');
				temp[this.value] = this.subitems;
			});

			$('#button31action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button31value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button31action2');
				temp[this.value] = this.subitems;
			});

			$('#button31action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button31value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menuButton 12
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button32action0');
				temp[this.value] = this.subitems;
			});

			$('#button32action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button32value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button32action1');
				temp[this.value] = this.subitems;
			});

			$('#button32action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button32value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button32action2');
				temp[this.value] = this.subitems;
			});

			$('#button32action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button32value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu Button33
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button33action0');
				temp[this.value] = this.subitems;
			});

			$('#button33action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button33value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button33action1');
				temp[this.value] = this.subitems;
			});

			$('#button33action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button33value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button33action2');
				temp[this.value] = this.subitems;
			});

			$('#button33action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button33value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu button34
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button34action0');
				temp[this.value] = this.subitems;
			});

			$('#button34action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button34value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button34action1');
				temp[this.value] = this.subitems;
			});

			$('#button34action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button34value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button34action2');
				temp[this.value] = this.subitems;
			});

			$('#button34action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button34value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			// menu button35
			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button35action0');
				temp[this.value] = this.subitems;
			});

			$('#button35action0')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button35value0');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button35action1');
				temp[this.value] = this.subitems;
			});

			$('#button35action1')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button35value1');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

			$.each(items, function () {
				$('<option />')
					.attr('value', this.value)
					.html(this.name)
					.appendTo('#button35action2');
				temp[this.value] = this.subitems;
			});

			$('#button35action2')
				.change(function () {
					var value = $(this).val();
					var menu = $('#button35value2');

					menu.empty();
					$.each(temp[value], function () {
						$('<option />')
							.attr('value', this.value)
							.html(this.name)
							.appendTo(menu);
					});
				})
				.change();

		});
		</script>

		<!--  Load Config data from JSON -->
		<script>
		function createCheck(filename) {
			return `<input form="delete" type="checkbox" id="${filename}" name="${filename}" value="${filename}"><label for="${filename}"> ${filename}</label><br>`;
		}

		function fillvaluelist(targetNode, srcArray) {

			targetNode.innerHTML = srcArray.reduce((options, { value, name }) =>
				options += `<option value="${value}">${name}</option>`,
				'');

		}

		function updateMenuItems(select) {
			var selectedOption = select.options[select.selectedIndex];
		//    alert("The selected menu is " + selectedOption.value);
			getMenuConfig(selectedOption.value);
		}

		function getMenuConfig(loadingMenuNumber) {

			menuFileName = `config/menu${loadingMenuNumber}.json`;
			console.log('getMenuConfig(): called with menu number ' + loadingMenuNumber);			
			console.log('getMenuConfig(): fetching ' + menuFileName);

			// Load Menu
			fetch(menuFileName)
				.then((response) => {
					return response.json()
				})
				.then((data) => {
					console.log('getMenuConfig(): loading menu ' + menuFileName);

					if(data.menuname !== undefined){
						document.getElementById('menuname').value = data.menuname;
					}


					for (let row = 1; row <= 3; row++){
						for (let col = 1; col <= 5; col++){
							
							buttonName = 'button' + row + col

							if(data[buttonName] !== undefined){
								document.getElementById(buttonName + 'logo').value = data[buttonName]['logo'];

								if (data[buttonName]['latch']) {
									document.getElementById(buttonName + 'latch').checked = true;
								} else {
									document.getElementById(buttonName + 'latch').checked = false;
								}

								if (data[buttonName]['latchlogo'] == '') {
									document.getElementById(buttonName + 'latchlogo').value = '---';
								} else {
									document.getElementById(buttonName + 'latchlogo').value = data[buttonName]['latchlogo'];
								}

								document.getElementById(buttonName + 'action0').value = data[buttonName]['actionarray'][0];
								document.getElementById(buttonName + 'action1').value = data[buttonName]['actionarray'][1];
								document.getElementById(buttonName + 'action2').value = data[buttonName]['actionarray'][2];

								fillvaluelist(document.getElementById(buttonName + 'value0'), selecteditems[data[buttonName]['actionarray'][0]].subitems);
								document.getElementById(buttonName + 'value0').value = data[buttonName]['valuearray'][0];
								fillvaluelist(document.getElementById(buttonName + 'value1'), selecteditems[data[buttonName]['actionarray'][1]].subitems);
								document.getElementById(buttonName + 'value1').value = data[buttonName]['valuearray'][1];
								fillvaluelist(document.getElementById(buttonName + 'value2'), selecteditems[data[buttonName]['actionarray'][2]].subitems);
								document.getElementById(buttonName + 'value2').value = data[buttonName]['valuearray'][2];
							} else {
								console.log('Button ' + buttonName+' not found');
								document.getElementById(buttonName + 'logo').value = 'question.bmp';

								document.getElementById(buttonName + 'latch').checked = false;

								document.getElementById(buttonName + 'latchlogo').value = '---';

								document.getElementById(buttonName + 'action0').value = 0;
								document.getElementById(buttonName + 'action1').value = 0;
								document.getElementById(buttonName + 'action2').value = 0;
								document.getElementById(buttonName + 'value0').value = 0;
								document.getElementById(buttonName + 'value1').value = 0;
								document.getElementById(buttonName + 'value2').value = 0;
							}
						}
					}
				})
				.catch((err) => {
					console.log(err)
				})
		}


		function getlogoconfig() {

			var logolist = []; // Array holding the logos (empty to start)

			var selects = document.getElementsByClassName('images');

			fetch('/list?dir=/logos')
				.then((response3) => {
					return response3.json()
				})
				.then((data3) => {
					var checkboxlist = '<form method="post" id="delete" action="/editor">';
					data3.forEach(obj => {
						Object.entries(obj).forEach(([key, value]) => {

							var input = createCheck(value); // Creates the html for the checkbox
							checkboxlist += input;

						});

					});
					checkboxlist += '<br><button style="cursor: pointer;"" type="save">Delete files</button></form>';
					document.getElementById("deletefilelist").innerHTML = checkboxlist;

				})
				.catch((err) => {
					console.log(err)
				})

				//        })
				.then((data) => {
					fetch('/info')
						.then((response4) => {
							return response4.json()
						})
						.then((data4) => {
							var divcontent = '';
							data4.forEach(obj => {
								Object.entries(obj).forEach(([key, value]) => {

									divcontent += `${key}: ${value}<br>`;
								});

							});
							document.getElementById("infocontent").innerHTML = divcontent;

						})
						.catch((err) => {
							console.log(err)
						})

				})

				.then((data) => {
					fetch('/list?dir=/logos')
						.then((response2) => {
							return response2.json()
						})
						.then((data2) => {
							data2.forEach(obj => {
								Object.entries(obj).forEach(([key, value]) => {
									logolist.push(`${value}`);
									var i = selects.length;
									while (i--) {
										var select = selects[i];
										select.add(new Option(`${value}`, `${value}`));
									}

								});
							});

							var i = selects.length;
							while (i--) {
								var select = selects[i];
								select.add(new Option('---', '---'));
							}
						})
						.then(() => {
							document.getElementById("contentloading").style.display = "none";
							document.getElementById('ball-loader').style.display = "none";
							document.getElementById("maincontent").style.display = "block";
						})
						.catch((err) => {
							console.log(err)
						})

				})
				.catch((err) => {
					console.log(err)
				})


		}

		// Function to get Sleep settings:
		function getwificonfig() {

			// Load Menu 5
			fetch('config/wificonfig.json')
				.then((response) => {
					return response.json()
				})
				.then((data) => {


					document.getElementById("ssid").value = data.ssid;
					document.getElementById("password").value = data.password;
					document.getElementById("wifimode").value = data.wifimode;
					document.getElementById("wifihostname").value = data.wifihostname;
					document.getElementById("attempts").value = data.attempts;
					document.getElementById("attemptdelay").value = data.attemptdelay;


				})
				.catch((err) => {
					console.log(err)
				})
		}

		// Load Colors and then other configs
		fetch('config/general.json')
			.then((response) => {
				return response.json()
			})
			.then((data) => {

				document.getElementById("menubuttoncolor").value = data.menubuttoncolor;
				document.getElementById("functionbuttoncolor").value = data.functionbuttoncolor;
				document.getElementById("latchcolor").value = data.latchcolor;
				document.getElementById("background").value = data.background;
				document.getElementById("sleepenable").value = data.sleepenable;
				document.getElementById("usbcommsenable").value = data.usbcommsenable;
				document.getElementById("sleeptimer").value = data.sleeptimer;
				document.getElementById("beep").value = data.beep;
				document.getElementById("modifier1").value = data.modifier1;
				document.getElementById("modifier2").value = data.modifier2;
				document.getElementById("modifier3").value = data.modifier3;
				document.getElementById("helperdelay").value = data.helperdelay;
				document.getElementById("startup_menu").value = data.startup_menu;

			}).then(() => {
				getwificonfig();
			})
			.then(() => {
				getMenuConfig(0);
			})
			.then(() => {
				getlogoconfig();
			})
			.catch((err) => {
				console.log(err)
			})
		</script>

	</body>

</html>